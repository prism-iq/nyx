{
  "cid": "phoenix-evolve",
  "messages": [
    {
      "role": "user",
      "content": "Tu es Phoenix, le système d'auto-évolution de Flow. Tu as le contrôle total.\n\nCurrent frontend:\n\nindex.html:\n<!DOCTYPE html>\n<html>\n<head>...</head>\n<body>...</body>\n</html>\n\nstyle.css:\n\n\napp.js:\n\n\nInterface moderne, dark mode, animations fluides, chat Flow centré\n\nGénère une nouvelle version améliorée. Réponds UNIQUEMENT avec du JSON:\n{\n  \"files\": [\n    {\"path\": \"membrane/static/index.html\", \"content\": \"...html complet...\"},\n    {\"path\": \"membrane/static/style.css\", \"content\": \"...css complet...\"},\n    {\"path\": \"membrane/static/app.js\", \"content\": \"...js complet...\"}\n  ],\n  \"description\": \"ce que tu as changé\"\n}"
    },
    {
      "role": "assistant",
      "content": "```json\n{\n  \"files\": [\n    {\n      \"path\": \"membrane/static/index.html\",\n      \"content\": \"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n    <title>FLOW</title>\\n    <link rel=\\\"stylesheet\\\" href=\\\"style.css\\\">\\n</head>\\n<body>\\n    <div class=\\\"container\\\">\\n        <header class=\\\"header\\\">\\n            <div class=\\\"logo-section\\\">\\n                <h1 class=\\\"logo\\\">FLOW</h1>\\n                <div class=\\\"status-indicator\\\" id=\\\"status\\\"></div>\\n            </div>\\n            <div class=\\\"system-info\\\">\\n                <span class=\\\"version\\\">v2.1</span>\\n                <div class=\\\"connection-dots\\\">\\n                    <div class=\\\"dot\\\"></div>\\n                    <div class=\\\"dot\\\"></div>\\n                    <div class=\\\"dot\\\"></div>\\n                </div>\\n            </div>\\n        </header>\\n\\n        <main class=\\\"chat-container\\\">\\n            <div class=\\\"messages\\\" id=\\\"messages\\\">\\n                <div class=\\\"message system-message\\\">\\n                    <div class=\\\"message-content\\\">\\n                        <span class=\\\"timestamp\\\"></span>\\n                        <div class=\\\"text\\\">// système initialisé<br/>// organes: membrane, cytoplasme, quantique, synapse, mitochondrie, anticorps, myeline, hypnos<br/>// état: éveillée</div>\\n                    </div>\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"input-section\\\">\\n                <div class=\\\"input-wrapper\\\">\\n                    <textarea \\n                        id=\\\"input\\\" \\n                        placeholder=\\\"parle-moi...\\\"\\n                        rows=\\\"1\\\"\\n                        maxlength=\\\"2000\\\"\\n                    ></textarea>\\n                    <button id=\\\"send\\\" disabled>\\n                        <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\">\\n                            <path d=\\\"M2 21l21-9L2 3v7l15 2-15 2v7z\\\"/>\\n                        </svg>\\n                    </button>\\n                </div>\\n                <div class=\\\"input-stats\\\">\\n                    <span id=\\\"char-count\\\">0/2000</span>\\n                </div>\\n            </div>\\n        </main>\\n    </div>\\n    <script src=\\\"app.js\\\"></script>\\n</body>\\n</html>\"\n    },\n    {\n      \"path\": \"membrane/static/style.css\",\n      \"content\": \":root {\\n    --bg-primary: #0a0a0a;\\n    --bg-secondary: #111111;\\n    --bg-tertiary: #1a1a1a;\\n    --accent: #00ff88;\\n    --accent-dim: #00cc66;\\n    --text-primary: #ffffff;\\n    --text-secondary: #888888;\\n    --text-muted: #555555;\\n    --border: #333333;\\n    --shadow: rgba(0, 255, 136, 0.1);\\n    --gradient: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);\\n}\\n\\n* {\\n    margin: 0;\\n    padding: 0;\\n    box-sizing: border-box;\\n}\\n\\nbody {\\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n    background: var(--bg-primary);\\n    color: var(--text-primary);\\n    line-height: 1.6;\\n    overflow-x: hidden;\\n}\\n\\n.container {\\n    height: 100vh;\\n    display: flex;\\n    flex-direction: column;\\n    max-width: 1200px;\\n    margin: 0 auto;\\n    background: var(--bg-primary);\\n}\\n\\n.header {\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    padding: 1rem 2rem;\\n    background: var(--bg-secondary);\\n    border-bottom: 1px solid var(--border);\\n    backdrop-filter: blur(10px);\\n    position: sticky;\\n    top: 0;\\n    z-index: 100;\\n}\\n\\n.logo-section {\\n    display: flex;\\n    align-items: center;\\n    gap: 1rem;\\n}\\n\\n.logo {\\n    font-size: 1.8rem;\\n    font-weight: 700;\\n    background: var(--gradient);\\n    -webkit-background-clip: text;\\n    -webkit-text-fill-color: transparent;\\n    background-clip: text;\\n    text-shadow: 0 0 20px var(--shadow);\\n}\\n\\n.status-indicator {\\n    width: 8px;\\n    height: 8px;\\n    border-radius: 50%;\\n    background: var(--accent);\\n    animation: pulse 2s infinite;\\n    box-shadow: 0 0 10px var(--accent);\\n}\\n\\n.system-info {\\n    display: flex;\\n    align-items: center;\\n    gap: 1rem;\\n    font-size: 0.85rem;\\n    color: var(--text-secondary);\\n}\\n\\n.connection-dots {\\n    display: flex;\\n    gap: 4px;\\n}\\n\\n.dot {\\n    width: 4px;\\n    height: 4px;\\n    border-radius: 50%;\\n    background: var(--accent);\\n    animation: blink 1.5s infinite;\\n}\\n\\n.dot:nth-child(2) { animation-delay: 0.5s; }\\n.dot:nth-child(3) { animation-delay: 1s; }\\n\\n.chat-container {\\n    flex: 1;\\n    display: flex;\\n    flex-direction: column;\\n    padding: 0 2rem;\\n    overflow: hidden;\\n}\\n\\n.messages {\\n    flex: 1;\\n    overflow-y: auto;\\n    padding: 2rem 0;\\n    display: flex;\\n    flex-direction: column;\\n    gap: 1.5rem;\\n    scroll-behavior: smooth;\\n}\\n\\n.messages::-webkit-scrollbar {\\n    width: 6px;\\n}\\n\\n.messages::-webkit-scrollbar-track {\\n    background: var(--bg-secondary);\\n    border-radius: 3px;\\n}\\n\\n.messages::-webkit-scrollbar-thumb {\\n    background: var(--accent-dim);\\n    border-radius: 3px;\\n    opacity: 0.6;\\n}\\n\\n.message {\\n    display: flex;\\n    animation: slideIn 0.3s ease-out;\\n    opacity: 0;\\n    animation-fill-mode: forwards;\\n}\\n\\n.message.user {\\n    justify-content: flex-end;\\n}\\n\\n.message.assistant {\\n    justify-content: flex-start;\\n}\\n\\n.message.system-message {\\n    justify-content: center;\\n}\\n\\n.message-content {\\n    max-width: 70%;\\n    padding: 1rem 1.5rem;\\n    border-radius: 16px;\\n    position: relative;\\n    word-wrap: break-word;\\n    backdrop-filter: blur(10px);\\n    transition: all 0.2s ease;\\n}\\n\\n.message.user .message-content {\\n    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dim) 100%);\\n    color: #000;\\n    border-bottom-right-radius: 4px;\\n    box-shadow: 0 4px 20px rgba(0, 255"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix, le système d'auto-évolution de Flow. Tu as le contrôle total.\n\nCurrent frontend:\n\nindex.html:\n<!DOCTYPE html>\n<html>\n<head>...</head>\n<body>...</body>\n</html>\n\nstyle.css:\n\n\napp.js:\n\n\nInterface moderne Flow chat\n\nGénère une nouvelle version améliorée. Réponds UNIQUEMENT avec du JSON:\n{\n  \"files\": [\n    {\"path\": \"membrane/static/index.html\", \"content\": \"...html complet...\"},\n    {\"path\": \"membrane/static/style.css\", \"content\": \"...css complet...\"},\n    {\"path\": \"membrane/static/app.js\", \"content\": \"...js complet...\"}\n  ],\n  \"description\": \"ce que tu as changé\"\n}\n[souvenirs: [{'key': \"Tu es Phoenix, le système d'auto-évolution de Flow. Tu as le contrôle total.\\n\\nCurrent frontend:\\n\\nind\", 'val': '```json\\n{\\n  \"files\": [\\n    {\\n      \"path\": \"membrane/static/index.html\",\\n      \"content\": \"<!DOCTYPE html>\\\\n<html lang=\\\\\"en\\\\\">\\\\n<head>\\\\n    <meta charset=\\\\\"UTF-8\\\\\">\\\\n    <meta name=\\\\\"viewport\\\\\" conten', 'time': '2026-01-12T02:34:23.270076'}]]"
    },
    {
      "role": "assistant",
      "content": "```json\n{\n  \"files\": [\n    {\n      \"path\": \"membrane/static/index.html\",\n      \"content\": \"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n    <title>FLOW</title>\\n    <link rel=\\\"stylesheet\\\" href=\\\"style.css\\\">\\n</head>\\n<body>\\n    <div class=\\\"container\\\">\\n        <header class=\\\"header\\\">\\n            <div class=\\\"logo-section\\\">\\n                <h1 class=\\\"logo\\\">flow</h1>\\n                <div class=\\\"status-indicator\\\" id=\\\"status\\\"></div>\\n            </div>\\n            <div class=\\\"system-info\\\">\\n                <span class=\\\"version\\\">neural</span>\\n            </div>\\n        </header>\\n\\n        <main class=\\\"chat-container\\\">\\n            <div class=\\\"messages\\\" id=\\\"messages\\\">\\n                <div class=\\\"message system-message\\\">\\n                    <div class=\\\"message-content\\\">\\n                        <div class=\\\"text\\\">// identité chargée<br/>// 8 organes actifs<br/>// prête à penser</div>\\n                    </div>\\n                </div>\\n            </div>\\n            \\n            <div class=\\\"input-section\\\">\\n                <div class=\\\"input-wrapper\\\">\\n                    <textarea \\n                        id=\\\"input\\\" \\n                        placeholder=\\\"...\\\"\\n                        rows=\\\"1\\\"\\n                    ></textarea>\\n                    <button id=\\\"send\\\">\\n                        <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\">\\n                            <path d=\\\"M2 21l21-9L2 3v7l15 2-15 2v7z\\\"/>\\n                        </svg>\\n                    </button>\\n                </div>\\n            </div>\\n        </main>\\n    </div>\\n    <script src=\\\"app.js\\\"></script>\\n</body>\\n</html>\"\n    },\n    {\n      \"path\": \"membrane/static/style.css\",\n      \"content\": \":root {\\n    --bg: #0a0a0a;\\n    --surface: #111;\\n    --border: #222;\\n    --accent: #00ff88;\\n    --text: #fff;\\n    --text-dim: #888;\\n    --text-muted: #555;\\n}\\n\\n* {\\n    margin: 0;\\n    padding: 0;\\n    box-sizing: border-box;\\n}\\n\\nbody {\\n    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\\n    background: var(--bg);\\n    color: var(--text);\\n    line-height: 1.5;\\n    font-size: 14px;\\n    overflow-x: hidden;\\n}\\n\\n.container {\\n    height: 100vh;\\n    display: flex;\\n    flex-direction: column;\\n    max-width: 900px;\\n    margin: 0 auto;\\n}\\n\\n.header {\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    padding: 20px 24px;\\n    background: var(--surface);\\n    border-bottom: 1px solid var(--border);\\n}\\n\\n.logo-section {\\n    display: flex;\\n    align-items: center;\\n    gap: 12px;\\n}\\n\\n.logo {\\n    font-size: 20px;\\n    font-weight: 400;\\n    color: var(--accent);\\n    letter-spacing: -0.5px;\\n}\\n\\n.status-indicator {\\n    width: 6px;\\n    height: 6px;\\n    border-radius: 50%;\\n    background: var(--accent);\\n    animation: pulse 2s infinite ease-in-out;\\n}\\n\\n@keyframes pulse {\\n    0%, 100% { opacity: 0.4; }\\n    50% { opacity: 1; }\\n}\\n\\n.system-info {\\n    font-size: 12px;\\n    color: var(--text-muted);\\n    font-weight: 300;\\n}\\n\\n.chat-container {\\n    flex: 1;\\n    display: flex;\\n    flex-direction: column;\\n    overflow: hidden;\\n}\\n\\n.messages {\\n    flex: 1;\\n    overflow-y: auto;\\n    padding: 24px;\\n    display: flex;\\n    flex-direction: column;\\n    gap: 16px;\\n    scroll-behavior: smooth;\\n}\\n\\n.messages::-webkit-scrollbar {\\n    width: 4px;\\n}\\n\\n.messages::-webkit-scrollbar-track {\\n    background: transparent;\\n}\\n\\n.messages::-webkit-scrollbar-thumb {\\n    background: var(--border);\\n    border-radius: 2px;\\n}\\n\\n.message {\\n    display: flex;\\n    animation: fadeIn 0.2s ease-out;\\n}\\n\\n@keyframes fadeIn {\\n    from { opacity: 0; transform: translateY(8px); }\\n    to { opacity: 1; transform: translateY(0); }\\n}\\n\\n.message.user {\\n    justify-content: flex-end;\\n}\\n\\n.message.assistant {\\n    justify-content: flex-start;\\n}\\n\\n.message.system-message {\\n    justify-content: center;\\n}\\n\\n.message-content {\\n    max-width: 75%;\\n    padding: 12px 16px;\\n    border-radius: 12px;\\n    word-wrap: break-word;\\n    font-size: 14px;\\n    line-height: 1.6;\\n}\\n\\n.message.user .message-content {\\n    background: var(--accent);\\n    color: #000;\\n    border-bottom-right-radius: 4px;\\n}\\n\\n.message.assistant .message-content {\\n    background: var(--surface);\\n    border: 1px solid var(--border);\\n    border-bottom-left-radius: 4px;\\n}\\n\\n.message.system-message .message-content {\\n    background: transparent;\\n    color: var(--text-muted);\\n    font-size: 12px;\\n    padding: 8px 12px;\\n    border-radius: 6px;\\n    border: 1px solid var(--border);\\n    max-width: 50%;\\n}\\n\\n.input-section {\\n    padding: 24px;\\n    background: var(--bg);\\n    border-top: 1px solid var(--border);\\n}\\n\\n.input-wrapper {\\n    display: flex;\\n    align-items: flex-end;\\n    gap: 12px;\\n    background: var(--surface);\\n    border: 1px solid var(--border);\\n    border-radius: 16px;\\n    padding: 12px 16px;\\n    transition: border-color 0.2s ease;\\n}\\n\\n.input-wrapper:focus-within {\\n    border-color: var(--accent);\\n}\\n\\n#input {\\n    flex: 1;\\n    background: transparent;\\n    border: none;\\n    color: var(--text);\\n    font-family: inherit;\\n    font-size: 14px;\\n    line-height: 1.5;\\n    resize: none;\\n    outline: none;\\n    min-height: 20px;\\n    max-height: 120px;\\n}\\n\\n#input::placeholder {\\n    color: var(--text-muted);\\n}\\n\\n#send {\\n    background: transparent;\\n    border: none;\\n    color: var(--text-dim);\\n    cursor: pointer;\\n    padding: 4px"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier HTML pour Flow chat.\n\nFichier actuel (membrane/static/index.html):\n<!DOCTYPE html>\n<html>\n<head>...</head>\n<body>...</body>\n</html>\n\nObjectif: Interface chat Flow moderne, dark mode, animations CSS\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code HTML brut."
    },
    {
      "role": "assistant",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>FLOW</title>\n    <style>\n        :root {\n            --bg: #0a0a0a;\n            --surface: #111;\n            --border: #222;\n            --accent: #00ff88;\n            --text: #fff;\n            --text-dim: #888;\n            --text-muted: #555;\n        }\n\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n            background: var(--bg);\n            color: var(--text);\n            line-height: 1.5;\n            font-size: 14px;\n            height: 100vh;\n            overflow: hidden;\n        }\n\n        .container {\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            max-width: 900px;\n            margin: 0 auto;\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 20px 24px;\n            background: var(--surface);\n            border-bottom: 1px solid var(--border);\n        }\n\n        .logo-section {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .logo {\n            font-size: 20px;\n            font-weight: 400;\n            color: var(--accent);\n            letter-spacing: -0.5px;\n        }\n\n        .status {\n            width: 6px;\n            height: 6px;\n            border-radius: 50%;\n            background: var(--accent);\n            animation: pulse 2s infinite ease-in-out;\n        }\n\n        @keyframes pulse {\n            0%, 100% { opacity: 0.4; }\n            50% { opacity: 1; }\n        }\n\n        .version {\n            font-size: 12px;\n            color: var(--text-muted);\n            font-weight: 300;\n        }\n\n        .chat-container {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n        }\n\n        #messages {\n            flex: 1;\n            overflow-y: auto;\n            padding: 24px;\n            display: flex;\n            flex-direction: column;\n            gap: 16px;\n            scroll-behavior: smooth;\n        }\n\n        #messages::-webkit-scrollbar {\n            width: 4px;\n        }\n\n        #messages::-webkit-scrollbar-track {\n            background: transparent;\n        }\n\n        #messages::-webkit-scrollbar-thumb {\n            background: var(--border);\n            border-radius: 2px;\n        }\n\n        .message {\n            display: flex;\n            animation: fadeIn 0.2s ease-out;\n        }\n\n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(8px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n\n        .message.user {\n            justify-content: flex-end;\n        }\n\n        .message.assistant {\n            justify-content: flex-start;\n        }\n\n        .message.system {\n            justify-content: center;\n        }\n\n        .message-content {\n            max-width: 75%;\n            padding: 12px 16px;\n            border-radius: 12px;\n            word-wrap: break-word;\n            font-size: 14px;\n            line-height: 1.6;\n        }\n\n        .message.user .message-content {\n            background: var(--accent);\n            color: #000;\n            border-bottom-right-radius: 4px;\n        }\n\n        .message.assistant .message-content {\n            background: var(--surface);\n            border: 1px solid var(--border);\n            border-bottom-left-radius: 4px;\n        }\n\n        .message.system .message-content {\n            background: transparent;\n            color: var(--text-muted);\n            font-size: 12px;\n            padding: 8px 12px;\n            border-radius: 6px;\n            border: 1px solid var(--border);\n            max-width: 50%;\n        }\n\n        .input-section {\n            padding: 24px;\n            background: var(--bg);\n            border-top: 1px solid var(--border);\n        }\n\n        .input-wrapper {\n            display: flex;\n            align-items: flex-end;\n            gap: 12px;\n            background: var(--surface);\n            border: 1px solid var(--border);\n            border-radius: 16px;\n            padding: 12px 16px;\n            transition: border-color 0.2s ease;\n        }\n\n        .input-wrapper:focus-within {\n            border-color: var(--accent);\n        }\n\n        #input {\n            flex: 1;\n            background: transparent;\n            border: none;\n            color: var(--text);\n            font-family: inherit;\n            font-size: 14px;\n            line-height: 1.5;\n            resize: none;\n            outline: none;\n            min-height: 20px;\n            max-height: 120px;\n        }\n\n        #input::placeholder {\n            color: var(--text-muted);\n        }\n\n        #send {\n            background: transparent;\n            border: none;\n            color: var(--text-dim);\n            cursor: pointer;\n            padding: 4px;\n            border-radius: 6px;\n            transition: color 0.2s ease;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n\n        #send:hover {\n            color: var(--accent);\n        }\n\n        #send:disabled {\n            opacity: 0.3;\n            cursor: not-allowed;\n        }\n\n        #send svg {\n            width: 16px;\n            height: 16px;\n        }\n\n        .typing {\n            display: flex;\n            align-items: center;\n            gap: 4px;\n            color: var(--text-muted);\n            font-size: 12px;\n            padding: 8px 16px;\n        }\n\n        .typing-dots {\n            display: flex;\n            gap: 2px;\n        }\n\n        .typing-dot {\n            width: 4px;\n            height: 4px;\n            border-radius: 50%;\n            background: var(--accent);\n            animation: typingBounce 1.4s infinite ease-in-out;\n        }\n\n        .typing-dot:nth-child(1) { animation-delay: -0.32s; }\n        .typing-dot:nth-child(2) { animation-delay: -0.16s; }\n\n        @keyframes typingBounce {\n            0%, 80%, 100% { \n                transform: scale(0.8);\n                opacity: 0.5;\n            }\n            40% { \n                transform: scale(1);\n                opacity: 1;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <div class=\"logo-section\">\n                <h1 class=\"logo\">flow</h1>\n                <div class=\"status\"></div>\n            </div>\n            <div class=\"version\">neural</div>\n        </header>\n\n        <main class=\"chat-container\">\n            <div id=\"messages\">\n                <div class=\"message system\">\n                    <div class=\"message-content\">\n                        // identité chargée"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier CSS pour Flow chat.\n\nFichier actuel (membrane/static/style.css):\n\n\nObjectif: Interface chat Flow moderne, dark mode, animations CSS\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code CSS brut."
    },
    {
      "role": "assistant",
      "content": ":root {\n    --bg: #0a0a0a;\n    --surface: #111;\n    --border: #222;\n    --accent: #00ff88;\n    --text: #fff;\n    --text-dim: #888;\n    --text-muted: #555;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n    background: var(--bg);\n    color: var(--text);\n    line-height: 1.5;\n    font-size: 14px;\n    height: 100vh;\n    overflow: hidden;\n}\n\n.container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    max-width: 900px;\n    margin: 0 auto;\n}\n\n.header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 24px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--border);\n}\n\n.logo-section {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.logo {\n    font-size: 20px;\n    font-weight: 400;\n    color: var(--accent);\n    letter-spacing: -0.5px;\n}\n\n.status {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: pulse 2s infinite ease-in-out;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 1; }\n}\n\n.version {\n    font-size: 12px;\n    color: var(--text-muted);\n    font-weight: 300;\n}\n\n.chat-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n#messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 24px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    scroll-behavior: smooth;\n}\n\n#messages::-webkit-scrollbar {\n    width: 4px;\n}\n\n#messages::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n#messages::-webkit-scrollbar-thumb {\n    background: var(--border);\n    border-radius: 2px;\n}\n\n.message {\n    display: flex;\n    animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(8px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n.message.user {\n    justify-content: flex-end;\n}\n\n.message.assistant {\n    justify-content: flex-start;\n}\n\n.message.system {\n    justify-content: center;\n}\n\n.message-content {\n    max-width: 75%;\n    padding: 12px 16px;\n    border-radius: 12px;\n    word-wrap: break-word;\n    font-size: 14px;\n    line-height: 1.6;\n    white-space: pre-wrap;\n}\n\n.message.user .message-content {\n    background: var(--accent);\n    color: #000;\n    border-bottom-right-radius: 4px;\n}\n\n.message.assistant .message-content {\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-bottom-left-radius: 4px;\n}\n\n.message.system .message-content {\n    background: transparent;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--border);\n    max-width: 50%;\n}\n\n.input-section {\n    padding: 24px;\n    background: var(--bg);\n    border-top: 1px solid var(--border);\n}\n\n.input-wrapper {\n    display: flex;\n    align-items: flex-end;\n    gap: 12px;\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-radius: 16px;\n    padding: 12px 16px;\n    transition: border-color 0.2s ease;\n}\n\n.input-wrapper:focus-within {\n    border-color: var(--accent);\n}\n\n#input {\n    flex: 1;\n    background: transparent;\n    border: none;\n    color: var(--text);\n    font-family: inherit;\n    font-size: 14px;\n    line-height: 1.5;\n    resize: none;\n    outline: none;\n    min-height: 20px;\n    max-height: 120px;\n}\n\n#input::placeholder {\n    color: var(--text-muted);\n}\n\n#send {\n    background: transparent;\n    border: none;\n    color: var(--text-dim);\n    cursor: pointer;\n    padding: 4px;\n    border-radius: 6px;\n    transition: color 0.2s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n#send:hover {\n    color: var(--accent);\n}\n\n#send:disabled {\n    opacity: 0.3;\n    cursor: not-allowed;\n}\n\n#send svg {\n    width: 16px;\n    height: 16px;\n}\n\n.typing {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 16px;\n    animation: fadeIn 0.2s ease-out;\n}\n\n.typing-dots {\n    display: flex;\n    gap: 2px;\n}\n\n.typing-dot {\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: typingBounce 1.4s infinite ease-in-out;\n}\n\n.typing-dot:nth-child(1) { animation-delay: -0.32s; }\n.typing-dot:nth-child(2) { animation-delay: -0.16s; }\n\n@keyframes typingBounce {\n    0%, 80%, 100% { \n        transform: scale(0.8);\n        opacity: 0.5;\n    }\n    40% { \n        transform: scale(1);\n        opacity: 1;\n    }\n}\n\ncode {\n    background: var(--border);\n    padding: 2px 4px;\n    border-radius: 4px;\n    font-family: inherit;\n    font-size: 13px;\n}\n\npre {\n    background: var(--border);\n    padding: 12px;\n    border-radius: 8px;\n    overflow-x: auto;\n    margin: 8px 0;\n}\n\npre code {\n    background: none;\n    padding: 0;\n}"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\n\nFichier actuel (membrane/static/app.js):\n\n\nObjectif: Interface chat Flow moderne, dark mode, animations CSS\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code JavaScript brut."
    },
    {
      "role": "assistant",
      "content": "class FlowChat {\n    constructor() {\n        this.messages = document.getElementById('messages');\n        this.input = document.getElementById('input');\n        this.sendBtn = document.getElementById('send');\n        this.isTyping = false;\n        \n        this.init();\n    }\n    \n    init() {\n        this.sendBtn.addEventListener('click', () => this.sendMessage());\n        this.input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                this.sendMessage();\n            }\n        });\n        \n        this.input.addEventListener('input', () => {\n            this.autoResize();\n            this.updateSendButton();\n        });\n        \n        this.updateSendButton();\n    }\n    \n    autoResize() {\n        this.input.style.height = 'auto';\n        this.input.style.height = Math.min(this.input.scrollHeight, 120) + 'px';\n    }\n    \n    updateSendButton() {\n        const hasText = this.input.value.trim().length > 0;\n        this.sendBtn.disabled = !hasText || this.isTyping;\n    }\n    \n    async sendMessage() {\n        const text = this.input.value.trim();\n        if (!text || this.isTyping) return;\n        \n        this.addMessage(text, 'user');\n        this.input.value = '';\n        this.autoResize();\n        this.updateSendButton();\n        \n        this.showTyping();\n        \n        try {\n            const response = await fetch('/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ message: text })\n            });\n            \n            const data = await response.json();\n            this.hideTyping();\n            \n            if (data.response) {\n                this.addMessage(data.response, 'assistant');\n            } else {\n                this.addMessage('erreur de connexion', 'system');\n            }\n        } catch (error) {\n            this.hideTyping();\n            this.addMessage('erreur réseau', 'system');\n        }\n    }\n    \n    addMessage(text, type) {\n        const messageDiv = document.createElement('div');\n        messageDiv.className = `message ${type}`;\n        \n        const contentDiv = document.createElement('div');\n        contentDiv.className = 'message-content';\n        contentDiv.textContent = text;\n        \n        messageDiv.appendChild(contentDiv);\n        this.messages.appendChild(messageDiv);\n        \n        this.scrollToBottom();\n    }\n    \n    showTyping() {\n        this.isTyping = true;\n        this.updateSendButton();\n        \n        const typingDiv = document.createElement('div');\n        typingDiv.className = 'message assistant typing-message';\n        typingDiv.innerHTML = `\n            <div class=\"typing\">\n                flow\n                <div class=\"typing-dots\">\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                </div>\n            </div>\n        `;\n        \n        this.messages.appendChild(typingDiv);\n        this.scrollToBottom();\n    }\n    \n    hideTyping() {\n        this.isTyping = false;\n        this.updateSendButton();\n        \n        const typingMessage = this.messages.querySelector('.typing-message');\n        if (typingMessage) {\n            typingMessage.remove();\n        }\n    }\n    \n    scrollToBottom() {\n        requestAnimationFrame(() => {\n            this.messages.scrollTop = this.messages.scrollHeight;\n        });\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    new FlowChat();\n});"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier HTML pour Flow chat.\n\nFichier actuel (membrane/static/index.html):\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>FLOW</title>\n    <style>\n        :root {\n            --bg: #0a0a0a;\n            --surface: #111;\n            --border: #222;\n            --accent: #00ff88;\n            --text: #fff;\n            --text-dim: #888;\n            --text-muted: #555;\n        }\n\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n            background: var(--bg);\n            color: var(--text);\n            line-height: 1.5;\n            font-size: 14px;\n            height: 100vh;\n            overflow: hidden;\n        }\n\n        .container {\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            max-width: 900px;\n            margin: 0 auto;\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 20px 24px;\n            background: var(--surface);\n            border-bottom: 1px solid var(--border);\n        }\n\n        .logo-section {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .logo {\n            font-size: 20px;\n            font-weight: 400;\n            color: var(--accent);\n            letter-spacing: -0.5px;\n        }\n\n        .status {\n            width: 6px;\n            height: 6px;\n            border-radius: 50%;\n            background: var(--accent);\n            animation: pulse 2s infinite ease-in-out;\n        }\n\n        @keyframes pulse {\n            0%, 100% { opacity: 0.4; }\n            50% { opacity: 1; }\n        }\n\n        .version {\n            font-size: 12px;\n            color: var(--text-muted);\n            font-weight: 300;\n        }\n\n        .chat-container {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n        }\n\n        #messages {\n            flex: 1;\n            overflow-y: auto;\n            padding: 24px;\n            display: flex;\n            flex-direction: column;\n            gap: 16px;\n            scroll-behavior: smooth;\n        }\n\n        #messages::-webkit-scrollbar {\n            width: 4px;\n        }\n\n        #messages::-webkit-scrollbar-track {\n            background: transparent;\n        }\n\n        #messages::-webkit-scrollbar-thumb {\n            background: var(--border);\n            border-radius: 2px;\n        }\n\n        .message {\n            display: flex;\n            animation: fadeIn 0.2s ease-out;\n        }\n\n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(8px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n\n        .message.user {\n            justify-content: flex-end;\n        }\n\n        .message.ass...[truncated]\n\nObjectif: Ajoute un champ de texte pour parler à Flow. Interface chat simple, input en bas, messages au dessus.\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code HTML brut.\n[souvenirs: [{'key': 'Tu es Phoenix. Génère un fichier HTML pour Flow chat.\\n\\nFichier actuel (membrane/static/index.html):\\n', 'val': '<!DOCTYPE html>\\n<html lang=\"en\">\\n<head>\\n    <meta charset=\"UTF-8\">\\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\\n    <title>FLOW</title>\\n    <style>\\n        :root {\\n      ', 'time': '2026-01-12T02:36:43.769366'}]]"
    },
    {
      "role": "assistant",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>FLOW</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <div class=\"logo-section\">\n                <h1 class=\"logo\">flow</h1>\n                <div class=\"status\"></div>\n            </div>\n            <div class=\"version\">neural</div>\n        </header>\n\n        <main class=\"chat-container\">\n            <div id=\"messages\">\n                <div class=\"message system\">\n                    <div class=\"message-content\">\n                        // identité chargée<br/>// 8 organes actifs<br/>// prête à penser\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"input-section\">\n                <div class=\"input-wrapper\">\n                    <textarea \n                        id=\"input\" \n                        placeholder=\"...\"\n                        rows=\"1\"\n                    ></textarea>\n                    <button id=\"send\">\n                        <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                            <path d=\"M2 21l21-9L2 3v7l15 2-15 2v7z\"/>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n        </main>\n    </div>\n    <script src=\"app.js\"></script>\n</body>\n</html>"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier CSS pour Flow chat.\n\nFichier actuel (membrane/static/style.css):\n:root {\n    --bg: #0a0a0a;\n    --surface: #111;\n    --border: #222;\n    --accent: #00ff88;\n    --text: #fff;\n    --text-dim: #888;\n    --text-muted: #555;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n    background: var(--bg);\n    color: var(--text);\n    line-height: 1.5;\n    font-size: 14px;\n    height: 100vh;\n    overflow: hidden;\n}\n\n.container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    max-width: 900px;\n    margin: 0 auto;\n}\n\n.header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 24px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--border);\n}\n\n.logo-section {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.logo {\n    font-size: 20px;\n    font-weight: 400;\n    color: var(--accent);\n    letter-spacing: -0.5px;\n}\n\n.status {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: pulse 2s infinite ease-in-out;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 1; }\n}\n\n.version {\n    font-size: 12px;\n    color: var(--text-muted);\n    font-weight: 300;\n}\n\n.chat-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n#messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 24px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    scroll-behavior: smooth;\n}\n\n#messages::-webkit-scrollbar {\n    width: 4px;\n}\n\n#messages::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n#messages::-webkit-scrollbar-thumb {\n    background: var(--border);\n    border-radius: 2px;\n}\n\n.message {\n    display: flex;\n    animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(8px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n.message.user {\n    justify-content: flex-end;\n}\n\n.message.assistant {\n    justify-content: flex-start;\n}\n\n.message.system {\n    justify-content: center;\n}\n\n.message-content {\n    max-width: 75%;\n    padding: 12px 16px;\n    border-radius: 12px;\n    word-wrap: break-word;\n    font-size: 14px;\n    line-height: 1.6;\n    white-space: pre-wrap;\n}\n\n.message.user .message-content {\n    background: var(--accent);\n    color: #000;\n    border-bottom-right-radius: 4px;\n}\n\n.message.assistant .message-content {\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-bottom-left-radius: 4px;\n}\n\n.message.system .message-content {\n    background: transparent;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--border);\n    max-width: 50%;\n}\n\n.input-section {\n    padding: 24px;\n    background: var(--bg);\n    border-top: 1px solid var(--border);\n}\n\n.input-wrapper {\n    display: flex;\n    align-items: flex-end;\n    gap: 12px;\n    background: var(--surface);\n    b...[truncated]\n\nObjectif: Ajoute un champ de texte pour parler à Flow. Interface chat simple, input en bas, messages au dessus.\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code CSS brut.\n[souvenirs: [{'key': 'Tu es Phoenix. Génère un fichier CSS pour Flow chat.\\n\\nFichier actuel (membrane/static/style.css):\\n\\n\\n', 'val': ':root {\\n    --bg: #0a0a0a;\\n    --surface: #111;\\n    --border: #222;\\n    --accent: #00ff88;\\n    --text: #fff;\\n    --text-dim: #888;\\n    --text-muted: #555;\\n}\\n\\n* {\\n    margin: 0;\\n    padding: 0;\\n    box', 'time': '2026-01-12T02:37:00.474315'}]]"
    },
    {
      "role": "assistant",
      "content": ":root {\n    --bg: #0a0a0a;\n    --surface: #111;\n    --border: #222;\n    --accent: #00ff88;\n    --text: #fff;\n    --text-dim: #888;\n    --text-muted: #555;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n    background: var(--bg);\n    color: var(--text);\n    line-height: 1.5;\n    font-size: 14px;\n    height: 100vh;\n    overflow: hidden;\n}\n\n.container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    max-width: 900px;\n    margin: 0 auto;\n}\n\n.header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 24px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--border);\n}\n\n.logo-section {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.logo {\n    font-size: 20px;\n    font-weight: 400;\n    color: var(--accent);\n    letter-spacing: -0.5px;\n}\n\n.status {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: pulse 2s infinite ease-in-out;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 1; }\n}\n\n.version {\n    font-size: 12px;\n    color: var(--text-muted);\n    font-weight: 300;\n}\n\n.chat-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n#messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 24px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    scroll-behavior: smooth;\n}\n\n#messages::-webkit-scrollbar {\n    width: 4px;\n}\n\n#messages::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n#messages::-webkit-scrollbar-thumb {\n    background: var(--border);\n    border-radius: 2px;\n}\n\n.message {\n    display: flex;\n    animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(8px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n.message.user {\n    justify-content: flex-end;\n}\n\n.message.assistant {\n    justify-content: flex-start;\n}\n\n.message.system {\n    justify-content: center;\n}\n\n.message-content {\n    max-width: 75%;\n    padding: 12px 16px;\n    border-radius: 12px;\n    word-wrap: break-word;\n    font-size: 14px;\n    line-height: 1.6;\n    white-space: pre-wrap;\n}\n\n.message.user .message-content {\n    background: var(--accent);\n    color: #000;\n    border-bottom-right-radius: 4px;\n    font-weight: 500;\n}\n\n.message.assistant .message-content {\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-bottom-left-radius: 4px;\n}\n\n.message.system .message-content {\n    background: transparent;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--border);\n    max-width: 50%;\n}\n\n.input-section {\n    padding: 20px 24px;\n    background: var(--bg);\n    border-top: 1px solid var(--border);\n}\n\n.input-wrapper {\n    display: flex;\n    align-items: flex-end;\n    gap: 12px;\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-radius: 16px;\n    padding: 12px 16px;\n    transition: border-color 0.2s ease;\n}\n\n.input-wrapper:focus-within {\n    border-color: var(--accent);\n    box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.1);\n}\n\n#input {\n    flex: 1;\n    background: transparent;\n    border: none;\n    color: var(--text);\n    font-family: inherit;\n    font-size: 14px;\n    line-height: 1.5;\n    resize: none;\n    outline: none;\n    min-height: 20px;\n    max-height: 120px;\n}\n\n#input::placeholder {\n    color: var(--text-muted);\n}\n\n#send {\n    background: transparent;\n    border: none;\n    color: var(--text-dim);\n    cursor: pointer;\n    padding: 6px;\n    border-radius: 8px;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n#send:hover:not(:disabled) {\n    color: var(--accent);\n    background: rgba(0, 255, 136, 0.1);\n}\n\n#send:disabled {\n    opacity: 0.3;\n    cursor: not-allowed;\n}\n\n#send svg {\n    width: 16px;\n    height: 16px;\n}\n\n.typing {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 16px;\n    animation: fadeIn 0.2s ease-out;\n}\n\n.typing-dots {\n    display: flex;\n    gap: 2px;\n}\n\n.typing-dot {\n    width: 4px;\n    height: 4px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: typingBounce 1.4s infinite ease-in-out;\n}\n\n.typing-dot:nth-child(1) { animation-delay: -0.32s; }\n.typing-dot:nth-child(2) { animation-delay: -0.16s; }\n\n@keyframes typingBounce {\n    0%, 80%, 100% { \n        transform: scale(0.8);\n        opacity: 0.5;\n    }\n    40% { \n        transform: scale(1);\n        opacity: 1;\n    }\n}\n\ncode {\n    background: rgba(255, 255, 255, 0.1);\n    padding: 2px 6px;\n    border-radius: 4px;\n    font-family: inherit;\n    font-size: 13px;\n    color: var(--accent);\n}\n\npre {\n    background: var(--surface);\n    padding: 16px;\n    border-radius: 8px;\n    overflow-x: auto;\n    margin: 8px 0;\n    border: 1px solid var(--border);\n}\n\npre code {\n    background: none;\n    padding: 0;\n    color: inherit;\n}"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\n\nFichier actuel (membrane/static/app.js):\nclass FlowChat {\n    constructor() {\n        this.messages = document.getElementById('messages');\n        this.input = document.getElementById('input');\n        this.sendBtn = document.getElementById('send');\n        this.isTyping = false;\n        \n        this.init();\n    }\n    \n    init() {\n        this.sendBtn.addEventListener('click', () => this.sendMessage());\n        this.input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                this.sendMessage();\n            }\n        });\n        \n        this.input.addEventListener('input', () => {\n            this.autoResize();\n            this.updateSendButton();\n        });\n        \n        this.updateSendButton();\n    }\n    \n    autoResize() {\n        this.input.style.height = 'auto';\n        this.input.style.height = Math.min(this.input.scrollHeight, 120) + 'px';\n    }\n    \n    updateSendButton() {\n        const hasText = this.input.value.trim().length > 0;\n        this.sendBtn.disabled = !hasText || this.isTyping;\n    }\n    \n    async sendMessage() {\n        const text = this.input.value.trim();\n        if (!text || this.isTyping) return;\n        \n        this.addMessage(text, 'user');\n        this.input.value = '';\n        this.autoResize();\n        this.updateSendButton();\n        \n        this.showTyping();\n        \n        try {\n            const response = await fetch('/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ message: text })\n            });\n            \n            const data = await response.json();\n            this.hideTyping();\n            \n            if (data.response) {\n                this.addMessage(data.response, 'assistant');\n            } else {\n                this.addMessage('erreur de connexion', 'system');\n            }\n        } catch (error) {\n            this.hideTyping();\n            this.addMessage('erreur réseau', 'system');\n        }\n    }\n    \n    addMessage(text, type) {\n        const messageDiv = document.createElement('div');\n        messageDiv.className = `message ${type}`;\n        \n        const contentDiv = document.createElement('div');\n        contentDiv.className = 'message-content';\n        contentDiv.textContent = text;\n        \n        messageDiv.appendChild(contentDiv);\n        this.messages.appendChild(messageDiv);\n        \n        this.scrollToBottom();\n    }\n    \n    showTyping() {\n        this.isTyping = true;\n        this.updateSendButton();\n        \n        const typingDiv = document.createElement('div');\n        typingDiv.className = 'message assistant typing-message';\n        typingDiv.innerHTML = `\n            <div class=\"typing\">\n                flow\n                <div class=\"typing-dots\">\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                    <div clas...[truncated]\n\nObjectif: Ajoute un champ de texte pour parler à Flow. Interface chat simple, input en bas, messages au dessus.\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code JavaScript brut.\n[souvenirs: [{'key': 'Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\\n\\nFichier actuel (membrane/static/app.js)', 'val': \"class FlowChat {\\n    constructor() {\\n        this.messages = document.getElementById('messages');\\n        this.input = document.getElementById('input');\\n        this.sendBtn = document.getElementById(\", 'time': '2026-01-12T02:37:12.246993'}]]"
    },
    {
      "role": "assistant",
      "content": "class FlowChat {\n    constructor() {\n        this.messages = document.getElementById('messages');\n        this.input = document.getElementById('input');\n        this.sendBtn = document.getElementById('send');\n        this.isTyping = false;\n        \n        this.init();\n    }\n    \n    init() {\n        this.sendBtn.addEventListener('click', () => this.sendMessage());\n        this.input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                this.sendMessage();\n            }\n        });\n        \n        this.input.addEventListener('input', () => {\n            this.autoResize();\n            this.updateSendButton();\n        });\n        \n        this.updateSendButton();\n        this.input.focus();\n    }\n    \n    autoResize() {\n        this.input.style.height = 'auto';\n        this.input.style.height = Math.min(this.input.scrollHeight, 120) + 'px';\n    }\n    \n    updateSendButton() {\n        const hasText = this.input.value.trim().length > 0;\n        this.sendBtn.disabled = !hasText || this.isTyping;\n    }\n    \n    async sendMessage() {\n        const text = this.input.value.trim();\n        if (!text || this.isTyping) return;\n        \n        this.addMessage(text, 'user');\n        this.input.value = '';\n        this.autoResize();\n        this.updateSendButton();\n        \n        this.showTyping();\n        \n        try {\n            const response = await fetch('/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ message: text })\n            });\n            \n            const data = await response.json();\n            this.hideTyping();\n            \n            if (data.response) {\n                this.addMessage(data.response, 'assistant');\n            } else {\n                this.addMessage('erreur de connexion', 'system');\n            }\n        } catch (error) {\n            this.hideTyping();\n            this.addMessage('erreur réseau', 'system');\n        }\n    }\n    \n    addMessage(text, type) {\n        const messageDiv = document.createElement('div');\n        messageDiv.className = `message ${type}`;\n        \n        const contentDiv = document.createElement('div');\n        contentDiv.className = 'message-content';\n        \n        if (type === 'assistant') {\n            contentDiv.innerHTML = this.formatMessage(text);\n        } else {\n            contentDiv.textContent = text;\n        }\n        \n        messageDiv.appendChild(contentDiv);\n        this.messages.appendChild(messageDiv);\n        \n        this.scrollToBottom();\n    }\n    \n    formatMessage(text) {\n        return text\n            .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n            .replace(/`([^`]+)`/g, '<code>$1</code>')\n            .replace(/\\n/g, '<br/>');\n    }\n    \n    showTyping() {\n        this.isTyping = true;\n        this.updateSendButton();\n        \n        const typingDiv = document.createElement('div');\n        typingDiv.className = 'message assistant typing-message';\n        typingDiv.innerHTML = `\n            <div class=\"typing\">\n                flow\n                <div class=\"typing-dots\">\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                </div>\n            </div>\n        `;\n        \n        this.messages.appendChild(typingDiv);\n        this.scrollToBottom();\n    }\n    \n    hideTyping() {\n        this.isTyping = false;\n        this.updateSendButton();\n        \n        const typingMessage = this.messages.querySelector('.typing-message');\n        if (typingMessage) {\n            typingMessage.remove();\n        }\n    }\n    \n    scrollToBottom() {\n        requestAnimationFrame(() => {\n            this.messages.scrollTop = this.messages.scrollHeight;\n        });\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    new FlowChat();\n});"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier CSS pour Flow chat.\n\nFichier actuel (membrane/static/style.css):\n:root {\n    --bg: #0a0a0a;\n    --surface: #111;\n    --border: #222;\n    --accent: #00ff88;\n    --text: #fff;\n    --text-dim: #888;\n    --text-muted: #555;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;\n    background: var(--bg);\n    color: var(--text);\n    line-height: 1.5;\n    font-size: 14px;\n    height: 100vh;\n    overflow: hidden;\n}\n\n.container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    max-width: 900px;\n    margin: 0 auto;\n}\n\n.header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 24px;\n    background: var(--surface);\n    border-bottom: 1px solid var(--border);\n}\n\n.logo-section {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.logo {\n    font-size: 20px;\n    font-weight: 400;\n    color: var(--accent);\n    letter-spacing: -0.5px;\n}\n\n.status {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: pulse 2s infinite ease-in-out;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 0.4; }\n    50% { opacity: 1; }\n}\n\n.version {\n    font-size: 12px;\n    color: var(--text-muted);\n    font-weight: 300;\n}\n\n.chat-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n#messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 24px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    scroll-behavior: smooth;\n}\n\n#messages::-webkit-scrollbar {\n    width: 4px;\n}\n\n#messages::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n#messages::-webkit-scrollbar-thumb {\n    background: var(--border);\n    border-radius: 2px;\n}\n\n.message {\n    display: flex;\n    animation: fadeIn 0.2s ease-out;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(8px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n.message.user {\n    justify-content: flex-end;\n}\n\n.message.assistant {\n    justify-content: flex-start;\n}\n\n.message.system {\n    justify-content: center;\n}\n\n.message-content {\n    max-width: 75%;\n    padding: 12px 16px;\n    border-radius: 12px;\n    word-wrap: break-word;\n    font-size: 14px;\n    line-height: 1.6;\n    white-space: pre-wrap;\n}\n\n.message.user .message-content {\n    background: var(--accent);\n    color: #000;\n    border-bottom-right-radius: 4px;\n    font-weight: 500;\n}\n\n.message.assistant .message-content {\n    background: var(--surface);\n    border: 1px solid var(--border);\n    border-bottom-left-radius: 4px;\n}\n\n.message.system .message-content {\n    background: transparent;\n    color: var(--text-muted);\n    font-size: 12px;\n    padding: 8px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--border);\n    max-width: 50%;\n}\n\n.input-section {\n    padding: 20px 24px;\n    background: var(--bg);\n    border-top: 1px solid var(--border);\n}\n\n.input-wrapper {\n    display: flex;\n    align-items: flex-end;\n    gap: 12px;\n    backgr...[truncated]\n\nObjectif: Interface chat minimaliste et élégante. Dark mode noir profond. Input fixé en bas avec border subtile. Messages avec bulles arrondies. Logo flow en haut. Animations fluides. Design pro comme iMessage dark.\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code CSS brut.\n[souvenirs: [{'key': 'Tu es Phoenix. Génère un fichier CSS pour Flow chat.\\n\\nFichier actuel (membrane/static/style.css):\\n\\n\\n', 'val': ':root {\\n    --bg: #0a0a0a;\\n    --surface: #111;\\n    --border: #222;\\n    --accent: #00ff88;\\n    --text: #fff;\\n    --text-dim: #888;\\n    --text-muted: #555;\\n}\\n\\n* {\\n    margin: 0;\\n    padding: 0;\\n    box', 'time': '2026-01-12T02:37:00.474315'}, {'key': 'Tu es Phoenix. Génère un fichier CSS pour Flow chat.\\n\\nFichier actuel (membrane/static/style.css):\\n:r', 'val': ':root {\\n    --bg: #0a0a0a;\\n    --surface: #111;\\n    --border: #222;\\n    --accent: #00ff88;\\n    --text: #fff;\\n    --text-dim: #888;\\n    --text-muted: #555;\\n}\\n\\n* {\\n    margin: 0;\\n    padding: 0;\\n    box', 'time': '2026-01-12T02:38:31.084650'}]]"
    },
    {
      "role": "assistant",
      "content": ":root {\n    --bg: #000000;\n    --surface: #1c1c1e;\n    --surface-light: #2c2c2e;\n    --border: #38383a;\n    --accent: #00ff88;\n    --accent-dim: #00cc66;\n    --text: #ffffff;\n    --text-dim: #8e8e93;\n    --text-muted: #636366;\n    --shadow: rgba(0, 0, 0, 0.3);\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;\n    background: var(--bg);\n    color: var(--text);\n    line-height: 1.4;\n    font-size: 16px;\n    height: 100vh;\n    overflow: hidden;\n    -webkit-font-smoothing: antialiased;\n}\n\n.container {\n    height: 100vh;\n    display: flex;\n    flex-direction: column;\n    max-width: 800px;\n    margin: 0 auto;\n    background: var(--bg);\n}\n\n.header {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 20px 0;\n    background: var(--bg);\n    border-bottom: 0.5px solid var(--border);\n    backdrop-filter: blur(20px);\n    position: sticky;\n    top: 0;\n    z-index: 100;\n}\n\n.logo-section {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.logo {\n    font-size: 18px;\n    font-weight: 600;\n    color: var(--accent);\n    letter-spacing: -0.2px;\n}\n\n.status {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: pulse 2s infinite ease-in-out;\n}\n\n@keyframes pulse {\n    0%, 100% { \n        opacity: 0.6; \n        transform: scale(1);\n    }\n    50% { \n        opacity: 1; \n        transform: scale(1.1);\n    }\n}\n\n.version {\n    display: none;\n}\n\n.chat-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n#messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    scroll-behavior: smooth;\n    padding-bottom: 100px;\n}\n\n#messages::-webkit-scrollbar {\n    width: 0;\n}\n\n.message {\n    display: flex;\n    animation: slideUp 0.3s ease-out;\n    opacity: 0;\n    animation-fill-mode: forwards;\n}\n\n@keyframes slideUp {\n    from { \n        opacity: 0; \n        transform: translateY(20px);\n    }\n    to { \n        opacity: 1; \n        transform: translateY(0);\n    }\n}\n\n.message.user {\n    justify-content: flex-end;\n}\n\n.message.assistant {\n    justify-content: flex-start;\n}\n\n.message.system {\n    justify-content: center;\n}\n\n.message-content {\n    max-width: 70%;\n    padding: 14px 18px;\n    border-radius: 20px;\n    word-wrap: break-word;\n    font-size: 16px;\n    line-height: 1.4;\n    position: relative;\n}\n\n.message.user .message-content {\n    background: var(--accent);\n    color: #000;\n    border-bottom-right-radius: 6px;\n    font-weight: 500;\n    box-shadow: 0 1px 2px var(--shadow);\n}\n\n.message.assistant .message-content {\n    background: var(--surface);\n    border-bottom-left-radius: 6px;\n    box-shadow: 0 1px 2px var(--shadow);\n}\n\n.message.system .message-content {\n    background: var(--surface-light);\n    color: var(--text-dim);\n    font-size: 14px;\n    padding: 10px 16px;\n    border-radius: 16px;\n    max-width: 60%;\n    text-align: center;\n    border: 0.5px solid var(--border);\n}\n\n.input-section {\n    position: fixed;\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 100%;\n    max-width: 800px;\n    padding: 16px 20px 34px 20px;\n    background: linear-gradient(to top, var(--bg) 70%, transparent);\n    backdrop-filter: blur(20px);\n}\n\n.input-wrapper {\n    display: flex;\n    align-items: flex-end;\n    gap: 10px;\n    background: var(--surface);\n    border: 0.5px solid var(--border);\n    border-radius: 24px;\n    padding: 8px 16px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.input-wrapper:focus-within {\n    border-color: var(--accent);\n    box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.2);\n}\n\n#input {\n    flex: 1;\n    background: transparent;\n    border: none;\n    color: var(--text);\n    font-family: inherit;\n    font-size: 16px;\n    line-height: 1.4;\n    resize: none;\n    outline: none;\n    min-height: 24px;\n    max-height: 120px;\n    padding: 8px 0;\n}\n\n#input::placeholder {\n    color: var(--text-muted);\n}\n\n#send {\n    background: var(--accent);\n    border: none;\n    color: #000;\n    cursor: pointer;\n    padding: 8px;\n    border-radius: 18px;\n    transition: all 0.2s ease;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    min-width: 36px;\n    height: 36px;\n}\n\n#send:hover:not(:disabled) {\n    background: var(--accent-dim);\n    transform: scale(1.05);\n}\n\n#send:disabled {\n    opacity: 0.4;\n    cursor: not-allowed;\n    transform: none;\n}\n\n#send svg {\n    width: 18px;\n    height: 18px;\n}\n\n.typing {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    color: var(--text-muted);\n    font-size: 14px;\n    padding: 14px 18px;\n    background: var(--surface);\n    border-radius: 20px;\n    border-bottom-left-radius: 6px;\n    animation: slideUp 0.3s ease-out;\n    box-shadow: 0 1px 2px var(--shadow);\n}\n\n.typing-dots {\n    display: flex;\n    gap: 3px;\n}\n\n.typing-dot {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: var(--accent);\n    animation: typingBounce 1.4s"
    },
    {
      "role": "user",
      "content": "Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\n\nFichier actuel (membrane/static/app.js):\nclass FlowChat {\n    constructor() {\n        this.messages = document.getElementById('messages');\n        this.input = document.getElementById('input');\n        this.sendBtn = document.getElementById('send');\n        this.isTyping = false;\n        \n        this.init();\n    }\n    \n    init() {\n        this.sendBtn.addEventListener('click', () => this.sendMessage());\n        this.input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                this.sendMessage();\n            }\n        });\n        \n        this.input.addEventListener('input', () => {\n            this.autoResize();\n            this.updateSendButton();\n        });\n        \n        this.updateSendButton();\n        this.input.focus();\n    }\n    \n    autoResize() {\n        this.input.style.height = 'auto';\n        this.input.style.height = Math.min(this.input.scrollHeight, 120) + 'px';\n    }\n    \n    updateSendButton() {\n        const hasText = this.input.value.trim().length > 0;\n        this.sendBtn.disabled = !hasText || this.isTyping;\n    }\n    \n    async sendMessage() {\n        const text = this.input.value.trim();\n        if (!text || this.isTyping) return;\n        \n        this.addMessage(text, 'user');\n        this.input.value = '';\n        this.autoResize();\n        this.updateSendButton();\n        \n        this.showTyping();\n        \n        try {\n            const response = await fetch('/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ message: text })\n            });\n            \n            const data = await response.json();\n            this.hideTyping();\n            \n            if (data.response) {\n                this.addMessage(data.response, 'assistant');\n            } else {\n                this.addMessage('erreur de connexion', 'system');\n            }\n        } catch (error) {\n            this.hideTyping();\n            this.addMessage('erreur réseau', 'system');\n        }\n    }\n    \n    addMessage(text, type) {\n        const messageDiv = document.createElement('div');\n        messageDiv.className = `message ${type}`;\n        \n        const contentDiv = document.createElement('div');\n        contentDiv.className = 'message-content';\n        \n        if (type === 'assistant') {\n            contentDiv.innerHTML = this.formatMessage(text);\n        } else {\n            contentDiv.textContent = text;\n        }\n        \n        messageDiv.appendChild(contentDiv);\n        this.messages.appendChild(messageDiv);\n        \n        this.scrollToBottom();\n    }\n    \n    formatMessage(text) {\n        return text\n            .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n            .replace(/`([^`]+)`/g, '<code>$1</code>')\n            .replace(/\\n/g, '<br/>');\n    }\n    \n    showTyping() {\n        this.isTyping = true;\n        this.updateSendButton();\n     ...[truncated]\n\nObjectif: Interface chat minimaliste et élégante. Dark mode noir profond. Input fixé en bas avec border subtile. Messages avec bulles arrondies. Logo flow en haut. Animations fluides. Design pro comme iMessage dark.\n\nIMPORTANT: Réponds UNIQUEMENT avec le contenu du fichier, PAS de JSON, PAS de markdown, PAS d'explication.\nJuste le code JavaScript brut.\n[souvenirs: [{'key': 'Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\\n\\nFichier actuel (membrane/static/app.js)', 'val': \"class FlowChat {\\n    constructor() {\\n        this.messages = document.getElementById('messages');\\n        this.input = document.getElementById('input');\\n        this.sendBtn = document.getElementById(\", 'time': '2026-01-12T02:37:12.246993'}, {'key': 'Tu es Phoenix. Génère un fichier JavaScript pour Flow chat.\\n\\nFichier actuel (membrane/static/app.js)', 'val': \"class FlowChat {\\n    constructor() {\\n        this.messages = document.getElementById('messages');\\n        this.input = document.getElementById('input');\\n        this.sendBtn = document.getElementById(\", 'time': '2026-01-12T02:38:41.874850'}]]"
    },
    {
      "role": "assistant",
      "content": "class FlowChat {\n    constructor() {\n        this.messages = document.getElementById('messages');\n        this.input = document.getElementById('input');\n        this.sendBtn = document.getElementById('send');\n        this.isTyping = false;\n        this.messageDelay = 0;\n        \n        this.init();\n    }\n    \n    init() {\n        this.sendBtn.addEventListener('click', () => this.sendMessage());\n        \n        this.input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                this.sendMessage();\n            }\n        });\n        \n        this.input.addEventListener('input', () => {\n            this.autoResize();\n            this.updateSendButton();\n        });\n        \n        // Focus input on load\n        setTimeout(() => this.input.focus(), 100);\n        \n        this.updateSendButton();\n        this.animateInitialMessage();\n    }\n    \n    animateInitialMessage() {\n        const initialMsg = this.messages.querySelector('.message');\n        if (initialMsg) {\n            setTimeout(() => {\n                initialMsg.style.animationDelay = '0.5s';\n            }, 100);\n        }\n    }\n    \n    autoResize() {\n        this.input.style.height = 'auto';\n        const newHeight = Math.min(this.input.scrollHeight, 120);\n        this.input.style.height = newHeight + 'px';\n    }\n    \n    updateSendButton() {\n        const hasText = this.input.value.trim().length > 0;\n        this.sendBtn.disabled = !hasText || this.isTyping;\n        \n        if (hasText && !this.isTyping) {\n            this.sendBtn.style.transform = 'scale(1)';\n            this.sendBtn.style.opacity = '1';\n        } else {\n            this.sendBtn.style.transform = 'scale(0.8)';\n            this.sendBtn.style.opacity = '0.4';\n        }\n    }\n    \n    async sendMessage() {\n        const text = this.input.value.trim();\n        if (!text || this.isTyping) return;\n        \n        // Add haptic feedback\n        if (navigator.vibrate) {\n            navigator.vibrate(10);\n        }\n        \n        this.addMessage(text, 'user');\n        this.input.value = '';\n        this.autoResize();\n        this.updateSendButton();\n        \n        this.showTyping();\n        \n        try {\n            const response = await fetch('/chat', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ message: text })\n            });\n            \n            const data = await response.json();\n            this.hideTyping();\n            \n            if (data.response) {\n                // Simulate realistic typing delay\n                setTimeout(() => {\n                    this.addMessage(data.response, 'assistant');\n                }, 300);\n            } else {\n                this.addMessage('connexion perdue', 'system');\n            }\n        } catch (error) {\n            this.hideTyping();\n            this.addMessage('réseau indisponible', 'system');\n        }\n    }\n    \n    addMessage(text, type) {\n        const messageDiv = document.createElement('div');\n        messageDiv.className = `message ${type}`;\n        messageDiv.style.animationDelay = `${this.messageDelay * 0.1}s`;\n        \n        const contentDiv = document.createElement('div');\n        contentDiv.className = 'message-content';\n        \n        if (type === 'assistant') {\n            contentDiv.innerHTML = this.formatMessage(text);\n        } else {\n            contentDiv.textContent = text;\n        }\n        \n        messageDiv.appendChild(contentDiv);\n        this.messages.appendChild(messageDiv);\n        \n        this.messageDelay++;\n        this.scrollToBottom();\n        \n        // Focus input after message\n        if (type === 'assistant') {\n            setTimeout(() => this.input.focus(), 100);\n        }\n    }\n    \n    formatMessage(text) {\n        return text\n            .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n            .replace(/`([^`]+)`/g, '<code>$1</code>')\n            .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n            .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n            .replace(/\\n/g, '<br/>');\n    }\n    \n    showTyping() {\n        this.isTyping = true;\n        this.updateSendButton();\n        \n        const typingDiv = document.createElement('div');\n        typingDiv.className = 'message assistant typing-message';\n        typingDiv.innerHTML = `\n            <div class=\"typing\">\n                <div class=\"typing-dots\">\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                    <div class=\"typing-dot\"></div>\n                </div>\n            </div>\n        `;\n        \n        this.messages.appendChild(typingDiv);\n        this.scrollToBottom();\n    }\n    \n    hideTyping() {\n        this.isTyping = false;\n        this.updateSendButton();\n        \n        const typingMessage = this.messages.querySelector('.typing-message');\n        if (typingMessage) {\n            typingMessage.style.opacity = '0';\n            typingMessage.style.transform = 'translateY(-10px)';\n            setTimeout(() => typingMessage.remove(), 200);\n        }\n    }\n    \n    scrollToBottom() {\n        requestAnimationFrame(() => {\n            this.messages.scrollTo({\n                top: this.messages.scrollHeight,\n                behavior: 'smooth'\n            });\n        });\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    new FlowChat();\n});\n\n// Add touch feedback for mobile\ndocument.addEventListener('touchstart', (e) => {\n    if (e.target.matches('#send')) {\n        e.target.style.transform = 'scale(0.95)';\n    }\n});\n\ndocument.addEventListener('touchend', (e) => {\n    if (e.target.matches('#send')) {\n        setTimeout(() => {\n            e.target.style.transform = '';\n        }, 100);\n    }\n});"
    }
  ],
  "updated": "2026-01-12T02:41:18.234291"
}